# Metaprogramming

## How ruby works?



## Monkey patching 
* On matrix multiplection example

```
class Fixnum
  alias_method :plus, :+

  def self.adds
    @adds ||= 0
  end

  def self.adds=(arg)
    @adds = arg
  end

  define_method(:+) do |arg|
    self.class.adds = self.class.adds.send(:plus, 1)
    self.send(:plus,arg)
  end

end
```

## attr_whatever

```
```


## Send method

```
class People

  def initialize(name)  
  	@name = name
  end
  
  def wake_up
  	puts "#{@name} is waking up!"
  end
  
  def say_hello_to_mom
  	puts "#{@name} is saying hello to mom!"
  end
  
  def brush_teeth
  	puts "#{name} is brushing teeth!"
  end
  
  def take_coffee
  	puts "#{@name} is taking coffee!"
  end
  
  def go_out
  	puts "#{@name} is going out!"
  end
  
end

dima = People.new("Dima")

dima.wake_up
sleep 0.3

dima.say_hello_to_mom
sleep 0.3


dima.brush_teeth
sleep 0.3

dima.take_coffee
sleep 0.3


dima.go_out
sleep 0.3

```

```
%i(wake_up say_hello_to_mom brush_teeth take_coffee go_out).each do |action|
 dima.send(action)
 sleep 0.3
end
```

## Define methods

## Method_missing

```
class Object
  def not
    Not.new(self)
  end

  class Not
    def initialize(original)
      @original = original
    end

    def method_missing(sym, *args, &blk)
      @original.send(sym, *args, &blk)
    end
  end
end

class Person
  attr_reader :name
  
  def initialize(name)
    @name = name
  end
  
  def smith?
    @name == "Smith"
  end
end

guys = []
guys << Person.new("Smith")
guys << Person.new("New")
guys << Person.new("Trinity")
guys << Person.new("Morphius")

guys.each do |guy|
  if guy.smith?
  	puts "Kick #{guy.name} ass!"
  else
  	puts "Give #{guy.name} a candy!"
  end
end


```

## Evals


